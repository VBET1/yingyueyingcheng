{"remainingRequest":"D:\\传出\\xm\\第六天\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js!D:\\传出\\xm\\第六天\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\传出\\xm\\第六天\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\传出\\xm\\第六天\\vue-admin-template\\src\\views\\system\\sysRole\\assignAuth.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\传出\\xm\\第六天\\vue-admin-template\\src\\views\\system\\sysRole\\assignAuth.vue","mtime":1727159817258},{"path":"D:\\传出\\xm\\第六天\\vue-admin-template\\babel.config.js","mtime":1726969584090},{"path":"D:\\传出\\xm\\第六天\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1726969924886},{"path":"D:\\传出\\xm\\第六天\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js","mtime":1726969926736},{"path":"D:\\传出\\xm\\第六天\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1726969924886},{"path":"D:\\传出\\xm\\第六天\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js","mtime":1726969927562}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucmVkdWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCgppbXBvcnQgYXBpIGZyb20gJ0AvYXBpL21lbnUvbWVudS5qcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQXNzaWduQXV0aCcsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICAvLyDnlKjmnaXmoIfor4bmmK/lkKbmraPlnKjkv53lrZjor7fmsYLkuK3nmoTmoIfor4YsIOmYsuatoumHjeWkjeaPkOS6pAogICAgICBzeXNNZW51TGlzdDogW10sCiAgICAgIC8vIOaJgOaciQogICAgICBkZWZhdWx0UHJvcHM6IHsKICAgICAgICBjaGlsZHJlbjogJ2NoaWxkcmVuJywKICAgICAgICBsYWJlbDogJ25hbWUnCiAgICAgIH0KICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5mZXRjaERhdGEoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8qDQogICAgICAgIOWIneWni+WMlg0KICAgICAgICAqLwogICAgZmV0Y2hEYXRhOiBmdW5jdGlvbiBmZXRjaERhdGEoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciByb2xlSWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5pZDsKICAgICAgYXBpLnRvQXNzaWduKHJvbGVJZCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgdmFyIHN5c01lbnVMaXN0ID0gcmVzdWx0LmRhdGE7CiAgICAgICAgX3RoaXMuc3lzTWVudUxpc3QgPSBzeXNNZW51TGlzdDsKICAgICAgICB2YXIgY2hlY2tlZElkcyA9IF90aGlzLmdldENoZWNrZWRJZHMoc3lzTWVudUxpc3QpOwogICAgICAgIGNvbnNvbGUubG9nKCdnZXRQZXJtaXNzaW9ucygpIGNoZWNrZWRJZHMnLCBjaGVja2VkSWRzKTsKICAgICAgICBfdGhpcy4kcmVmcy50cmVlLnNldENoZWNrZWRLZXlzKGNoZWNrZWRJZHMpOwogICAgICB9KTsKICAgIH0sCiAgICAvKg0KICAgICAgICDlvpfliLDmiYDmnInpgInkuK3nmoRpZOWIl+ihqA0KICAgICAgICAqLwogICAgZ2V0Q2hlY2tlZElkczogZnVuY3Rpb24gZ2V0Q2hlY2tlZElkcyhhdXRocykgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgdmFyIGluaXRBcnIgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IFtdOwogICAgICByZXR1cm4gYXV0aHMucmVkdWNlKGZ1bmN0aW9uIChwcmUsIGl0ZW0pIHsKICAgICAgICBpZiAoaXRlbS5zZWxlY3QgJiYgaXRlbS5jaGlsZHJlbi5sZW5ndGggPT09IDApIHsKICAgICAgICAgIHByZS5wdXNoKGl0ZW0uaWQpOwogICAgICAgIH0gZWxzZSBpZiAoaXRlbS5jaGlsZHJlbikgewogICAgICAgICAgX3RoaXMyLmdldENoZWNrZWRJZHMoaXRlbS5jaGlsZHJlbiwgaW5pdEFycik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBwcmU7CiAgICAgIH0sIGluaXRBcnIpOwogICAgfSwKICAgIC8qDQogICAgICAgIOS/neWtmOadg+mZkOWIl+ihqA0KICAgICAgICAqLwogICAgc2F2ZTogZnVuY3Rpb24gc2F2ZSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIGRlYnVnZ2VyOwogICAgICAvLyDojrflj5bliLDlvZPliY3lrZDoioLngrkKICAgICAgLy8gY29uc3QgY2hlY2tlZE5vZGVzID0gdGhpcy4kcmVmcy50cmVlLmdldENoZWNrZWROb2RlcygpCiAgICAgIC8vIOiOt+WPluWIsOW9k+WJjeWtkOiKgueCueWPiueItuiKgueCuQogICAgICB2YXIgYWxsQ2hlY2tlZE5vZGVzID0gdGhpcy4kcmVmcy50cmVlLmdldENoZWNrZWROb2RlcyhmYWxzZSwgdHJ1ZSk7CiAgICAgIHZhciBpZExpc3QgPSBhbGxDaGVja2VkTm9kZXMubWFwKGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgcmV0dXJuIG5vZGUuaWQ7CiAgICAgIH0pOwogICAgICBjb25zb2xlLmxvZyhpZExpc3QpOwogICAgICB2YXIgYXNzZ2luTWVudVZvID0gewogICAgICAgIHJvbGVJZDogdGhpcy4kcm91dGUucXVlcnkuaWQsCiAgICAgICAgbWVudUlkTGlzdDogaWRMaXN0CiAgICAgIH07CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIGFwaS5kb0Fzc2lnbihhc3NnaW5NZW51Vm8pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIF90aGlzMy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgX3RoaXMzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzdWx0LiRtZXNzYWdlIHx8ICfliIbphY3mnYPpmZDmiJDlip8nKTsKICAgICAgICBfdGhpczMuJHJvdXRlci5wdXNoKCcvc3lzdGVtL3N5c1JvbGUnKTsKICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["api","name","data","loading","sysMenuList","defaultProps","children","label","created","fetchData","methods","_this","roleId","$route","query","id","toAssign","then","result","checkedIds","getCheckedIds","console","log","$refs","tree","setCheckedKeys","auths","_this2","initArr","arguments","length","undefined","reduce","pre","item","select","push","save","_this3","allCheckedNodes","getCheckedNodes","idList","map","node","assginMenuVo","menuIdList","doAssign","$message","success","$router"],"sources":["src/views/system/sysRole/assignAuth.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <div style=\"padding: 20px 20px 0 20px\">\r\n      授权角色：{{ $route.query.roleName }}\r\n    </div>\r\n    <el-tree\r\n      style=\"margin: 20px 0\"\r\n      ref=\"tree\"\r\n      :data=\"sysMenuList\"\r\n      node-key=\"id\"\r\n      show-checkbox\r\n      default-expand-all\r\n      :props=\"defaultProps\"\r\n    />\r\n    <div style=\"padding: 20px 20px\">\r\n      <el-button\r\n        :loading=\"loading\"\r\n        type=\"primary\"\r\n        icon=\"el-icon-check\"\r\n        size=\"mini\"\r\n        @click=\"save\"\r\n      >保存</el-button>\r\n      <el-button\r\n        size=\"mini\"\r\n        icon=\"el-icon-refresh-right\"\r\n        @click=\"$router.push('/system/sysRole')\"\r\n      >返回</el-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport api from '@/api/menu/menu.js'\r\nexport default {\r\n  name: 'AssignAuth',\r\n\r\n  data() {\r\n    return {\r\n      loading: false, // 用来标识是否正在保存请求中的标识, 防止重复提交\r\n      sysMenuList: [], // 所有\r\n      defaultProps: {\r\n        children: 'children',\r\n        label: 'name'\r\n      }\r\n    }\r\n  },\r\n\r\n  created() {\r\n    this.fetchData()\r\n  },\r\n\r\n  methods: {\r\n    /*\r\n        初始化\r\n        */\r\n    fetchData() {\r\n      const roleId = this.$route.query.id\r\n      api.toAssign(roleId).then((result) => {\r\n        const sysMenuList = result.data\r\n        this.sysMenuList = sysMenuList\r\n        const checkedIds = this.getCheckedIds(sysMenuList)\r\n        console.log('getPermissions() checkedIds', checkedIds)\r\n        this.$refs.tree.setCheckedKeys(checkedIds)\r\n      })\r\n    },\r\n\r\n    /*\r\n        得到所有选中的id列表\r\n        */\r\n    getCheckedIds(auths, initArr = []) {\r\n      return auths.reduce((pre, item) => {\r\n        if (item.select && item.children.length === 0) {\r\n          pre.push(item.id)\r\n        } else if (item.children) {\r\n          this.getCheckedIds(item.children, initArr)\r\n        }\r\n        return pre\r\n      }, initArr)\r\n    },\r\n\r\n    /*\r\n        保存权限列表\r\n        */\r\n    save() {\r\n      debugger\r\n      // 获取到当前子节点\r\n      // const checkedNodes = this.$refs.tree.getCheckedNodes()\r\n      // 获取到当前子节点及父节点\r\n      const allCheckedNodes = this.$refs.tree.getCheckedNodes(false, true)\r\n      let idList = allCheckedNodes.map((node) => node.id)\r\n      console.log(idList)\r\n      let assginMenuVo = {\r\n        roleId: this.$route.query.id,\r\n        menuIdList: idList\r\n      }\r\n      this.loading = true\r\n      api.doAssign(assginMenuVo).then((result) => {\r\n        this.loading = false\r\n        this.$message.success(result.$message || '分配权限成功')\r\n        this.$router.push('/system/sysRole')\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA,OAAAA,GAAA;AACA;EACAC,IAAA;EAEAC,IAAA,WAAAA,KAAA;IACA;MACAC,OAAA;MAAA;MACAC,WAAA;MAAA;MACAC,YAAA;QACAC,QAAA;QACAC,KAAA;MACA;IACA;EACA;EAEAC,OAAA,WAAAA,QAAA;IACA,KAAAC,SAAA;EACA;EAEAC,OAAA;IACA;AACA;AACA;IACAD,SAAA,WAAAA,UAAA;MAAA,IAAAE,KAAA;MACA,IAAAC,MAAA,QAAAC,MAAA,CAAAC,KAAA,CAAAC,EAAA;MACAf,GAAA,CAAAgB,QAAA,CAAAJ,MAAA,EAAAK,IAAA,WAAAC,MAAA;QACA,IAAAd,WAAA,GAAAc,MAAA,CAAAhB,IAAA;QACAS,KAAA,CAAAP,WAAA,GAAAA,WAAA;QACA,IAAAe,UAAA,GAAAR,KAAA,CAAAS,aAAA,CAAAhB,WAAA;QACAiB,OAAA,CAAAC,GAAA,gCAAAH,UAAA;QACAR,KAAA,CAAAY,KAAA,CAAAC,IAAA,CAAAC,cAAA,CAAAN,UAAA;MACA;IACA;IAEA;AACA;AACA;IACAC,aAAA,WAAAA,cAAAM,KAAA;MAAA,IAAAC,MAAA;MAAA,IAAAC,OAAA,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA;MACA,OAAAH,KAAA,CAAAM,MAAA,WAAAC,GAAA,EAAAC,IAAA;QACA,IAAAA,IAAA,CAAAC,MAAA,IAAAD,IAAA,CAAA5B,QAAA,CAAAwB,MAAA;UACAG,GAAA,CAAAG,IAAA,CAAAF,IAAA,CAAAnB,EAAA;QACA,WAAAmB,IAAA,CAAA5B,QAAA;UACAqB,MAAA,CAAAP,aAAA,CAAAc,IAAA,CAAA5B,QAAA,EAAAsB,OAAA;QACA;QACA,OAAAK,GAAA;MACA,GAAAL,OAAA;IACA;IAEA;AACA;AACA;IACAS,IAAA,WAAAA,KAAA;MAAA,IAAAC,MAAA;MACA;MACA;MACA;MACA;MACA,IAAAC,eAAA,QAAAhB,KAAA,CAAAC,IAAA,CAAAgB,eAAA;MACA,IAAAC,MAAA,GAAAF,eAAA,CAAAG,GAAA,WAAAC,IAAA;QAAA,OAAAA,IAAA,CAAA5B,EAAA;MAAA;MACAM,OAAA,CAAAC,GAAA,CAAAmB,MAAA;MACA,IAAAG,YAAA;QACAhC,MAAA,OAAAC,MAAA,CAAAC,KAAA,CAAAC,EAAA;QACA8B,UAAA,EAAAJ;MACA;MACA,KAAAtC,OAAA;MACAH,GAAA,CAAA8C,QAAA,CAAAF,YAAA,EAAA3B,IAAA,WAAAC,MAAA;QACAoB,MAAA,CAAAnC,OAAA;QACAmC,MAAA,CAAAS,QAAA,CAAAC,OAAA,CAAA9B,MAAA,CAAA6B,QAAA;QACAT,MAAA,CAAAW,OAAA,CAAAb,IAAA;MACA;IACA;EACA;AACA","ignoreList":[]}]}